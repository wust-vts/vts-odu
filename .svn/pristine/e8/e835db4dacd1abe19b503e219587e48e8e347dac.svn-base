using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;

namespace YimaEncNavigator
{
    public partial class Form_ShipMiniInfoBox : Form
    {
        public int m_iShipPos = -1;
        public bool m_bFormShow = false;
        public Form_ShipMiniInfoBox()
        {
            InitializeComponent();
        }

        private void Form_ShipMiniInfoBox_Load(object sender, EventArgs e)
        {
            m_bFormShow = true;
        }

        public void RefreshInfo()
        {
            if (m_iShipPos > -1)
            {
                bool bArapValue = false;
                int iShipGeoX = 0;
                int iShipGeoY = 0;
                float fValue = 0;
                int iTimeValue = 0;
                string strValue = "";
                float fSpeed = 0;
                float fSCourse = 0;
                float fShipLen = 0;
                float fShipWidth = 0;
                string strShipName = new string(' ', 255);
                string strShipAttr = new string(' ', 255);
                int iShipMmsi = 0;

                ((FormMain)this.Owner).ymEncCtrl.GetOtherVesselCurrentInfo(m_iShipPos, ref bArapValue, ref iShipGeoX, ref iShipGeoY, ref fSCourse, ref fValue, ref fValue, ref fSpeed, ref fValue, ref iTimeValue, ref strValue);
                ((FormMain)this.Owner).ymEncCtrl.GetOtherVesselBasicInfo(m_iShipPos, ref fShipLen, ref fShipWidth, ref strShipName, ref iShipMmsi, ref strShipAttr);

                string strLon = InteropEncDotNet.GetDegreeStringFromGeoCoor(true, iShipGeoX, 10000000);
                string strLat = InteropEncDotNet.GetDegreeStringFromGeoCoor(false, iShipGeoY, 10000000);
                string strTime = InteropEncDotNet.MTime2String(iTimeValue);
                this.label_shipName.Text = "名称: " + strShipName;
                this.label_shipMmsi.Text = "MMSI: " + iShipMmsi.ToString();
                this.label_shipLon.Text = "经度: " + strLon;
                this.label_shipLat.Text = "纬度: " + strLat;
                this.label_shipSpeed.Text = "航速: " + fSpeed.ToString() + "节";
                this.label_shipCourse.Text = "航向: " + fSCourse.ToString() + "度";
                //this.label_shipType.Text = "船舶类型: " + strShipType;
                this.label_shipLastTime.Text = "最新报位: " + strTime;
            }
        }

        private void Form_ShipMiniInfoBox_FormClosed(object sender, FormClosedEventArgs e)
        {

        }

        private void Form_ShipMiniInfoBox_FormClosing(object sender, FormClosingEventArgs e)
        {
            //e.Cancel = true;
        }
    }
}
